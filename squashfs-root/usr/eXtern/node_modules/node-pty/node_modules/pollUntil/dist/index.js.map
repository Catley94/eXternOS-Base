{"version":3,"file":null,"sources":["../src/pollUntil.js"],"sourcesContent":["export default function pollUntil(fn, args = [], timeout = 3000, pollInterval = 200) {\n  if (typeof fn !== 'function') {\n    throw new Error('Polling function argumentmissing');\n  }\n\n  if (typeof args === 'number') {\n    pollInterval = timeout;\n    timeout = args;\n    args = [];\n  }\n\n  let s1;\n  let s2;\n\n  function clearSchedulers() {\n    clearTimeout(s1);\n    clearTimeout(s2);\n  }\n\n  const poller = new Promise((resolve) => {\n    (function poll() {\n      const result = fn.apply(this, args);\n      if (result) {\n        resolve(result);\n      } else {\n        s1 = setTimeout(poll, pollInterval);\n      }\n    }());\n  });\n\n  const timebomb = new Promise((resolve) => {\n    s2 = setTimeout(() => {\n      resolve(false);\n    }, timeout);\n  });\n\n  return Promise.race([poller, timebomb])\n    .then((res) => {\n      clearSchedulers();\n      return Promise.resolve(res);\n    })\n    .catch((err) => {\n      clearSchedulers();\n      throw new Error(err);\n    });\n}\n"],"names":["pollUntil","fn","args","timeout","pollInterval","Error","s1","s2","clearSchedulers","poller","resolve","poll","result","apply","setTimeout","timebomb","race","then","res","catch","err"],"mappings":";;;;;;AAAe,SAASA,SAAT,CAAmBC,EAAnB,EAAsE;MAA/CC,IAA+C,yDAAxC,EAAwC;MAApCC,OAAoC,yDAA1B,IAA0B;MAApBC,YAAoB,yDAAL,GAAK;;MAC/E,OAAOH,EAAP,KAAc,UAAlB,EAA8B;UACtB,IAAII,KAAJ,CAAU,kCAAV,CAAN;;;MAGE,OAAOH,IAAP,KAAgB,QAApB,EAA8B;mBACbC,OAAf;cACUD,IAAV;WACO,EAAP;;;MAGEI,WAAJ;MACIC,WAAJ;;WAESC,eAAT,GAA2B;iBACZF,EAAb;iBACaC,EAAb;;;MAGIE,SAAS,aAAY,UAACC,OAAD,EAAa;cAC5BC,IAAT,GAAgB;UACTC,SAASX,GAAGY,KAAH,CAAS,IAAT,EAAeX,IAAf,CAAf;UACIU,MAAJ,EAAY;gBACFA,MAAR;OADF,MAEO;aACAE,WAAWH,IAAX,EAAiBP,YAAjB,CAAL;;KALH,GAAD;GADa,CAAf;;MAWMW,WAAW,aAAY,UAACL,OAAD,EAAa;SACnCI,WAAW,YAAM;cACZ,KAAR;KADG,EAEFX,OAFE,CAAL;GADe,CAAjB;;SAMO,SAAQa,IAAR,CAAa,CAACP,MAAD,EAASM,QAAT,CAAb,EACJE,IADI,CACC,UAACC,GAAD,EAAS;;WAEN,SAAQR,OAAR,CAAgBQ,GAAhB,CAAP;GAHG,EAKJC,KALI,CAKE,UAACC,GAAD,EAAS;;UAER,IAAIf,KAAJ,CAAUe,GAAV,CAAN;GAPG,CAAP;;;"}